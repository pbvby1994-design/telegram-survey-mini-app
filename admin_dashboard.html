<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Админ-панель</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .hidden { display: none; }
        .error { color: red; }
        .admin { color: green; }
    </style>
</head>
<body>
    <h1>Админ-панель</h1>
    <div id="status">Инициализация…</div>
    <div id="userInfo" class="hidden">
        <p><strong>Пользователь:</strong> <span id="userName"></span></p>
        <p><strong>Telegram ID:</strong> <span id="userId"></span></p>
    </div>
    <div id="adminContent" class="hidden">
        <h2 class="admin">Вы — администратор</h2>
        <p>Здесь доступен административный функционал.</p>
        <!-- тут содержимое для админа -->
    </div>
    <div id="notAdminContent" class="hidden">
        <h2 class="error">Доступ запрещён</h2>
        <p>У вас нет прав администратора.</p>
    </div>
    <script type="module">
        (function() {
            const tg = window.Telegram?.WebApp;
            const ADMIN_TELEGRAM_ID = '541459471'; // <=== вставь здесь свой ID

            function showStatus(text) {
                document.getElementById('status').textContent = text;
            }

            function showUserInfo(user) {
                document.getElementById('userName').textContent = user.first_name + (user.last_name ? ' ' + user.last_name : '');
                document.getElementById('userId').textContent = user.id;
                document.getElementById('userInfo').classList.remove('hidden');
            }

            function showAdminContent() {
                document.getElementById('adminContent').classList.remove('hidden');
            }

            function showNotAdminContent() {
                document.getElementById('notAdminContent').classList.remove('hidden');
            }

            function init() {
                if (!tg) {
                    showStatus('❌ Приложение не запущено из Telegram WebApp.');
                    showNotAdminContent();
                    return;
                }

                tg.ready();

                const initDataUnsafe = tg.initDataUnsafe;
                if (!initDataUnsafe || !initDataUnsafe.user) {
                    showStatus('❌ Не удалось получить данные пользователя. Убедитесь, что WebApp открыт из бота через кнопку.');
                    showNotAdminContent();
                    return;
                }

                const user = initDataUnsafe.user;
                showStatus('✅ Инициализировано. Проверка прав администратора…');
                showUserInfo(user);

                const userIdStr = String(user.id);
                if (userIdStr === ADMIN_TELEGRAM_ID) {
                    showStatus('✅ Пользователь распознан как администратор.');
                    showAdminContent();
                } else {
                    showStatus('❌ Пользователь не является администратором.');
                    showNotAdminContent();
                }
            }

            document.addEventListener('DOMContentLoaded', init);
        })();
    </script>
</body>
</html>
